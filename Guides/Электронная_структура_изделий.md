# Работа с электронной структурой изделий

## Работа с подключениями

Функциональность подключений реализуется в классе **ComplexHierarchyLink** и доступна только для справочников с сложной иерархией.

```csharp
// Получение подкючения родительского объекта к дочернему
NomenclatureObject parent;
NomenclatureObject child;

ComplexHierarchyLink hLink = parent.GetChildLink(child); // Стоит отметить, что подкючений может быть много, так что правильнее пользоваться методом GetChildLinks

// Включение данного подключения к технологической структуре
Reference типыСтруктур = Context.Connection.ReferenceCatalog.Find(new Guid("b6e2f4e4-1167-478b-94b2-deb0dded4e29")).CreateReference();
ReferenceObject технологическаяСтруктура = типыСтруктур.Find(new Guid("633f08c5-4aef-44f8-924b-81c3e7339aea"));
Guid связьИспользованиеВСтруктурах = new Guid("77726357-b0eb-4cea-afa5-182e21eb6373"); // Связь подключения на справочник "Типы структур"

hLink.AddLinkedObject(связьИспользованиеВСтруктурах, технологическаяСтруктура);
```
