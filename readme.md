# Содержание папки с готовыми макросами

//TODO Исправить ссылки, дополнить файл недостающими данными

---
- [Макрос для создания подлинников](macro-for-creating-originals.cs)

Этот макрос был написан мной для бизнес процесса "Согласование КД на технологическое оснащение".
Макрос создан с нуля (т.е. это не отредактированный макрос ТопСистем).
Данный макрос выполняется через действие на компьютере пользователя (но как я понял, так же можно сделать так, чтобы данное действие выполнялось во время перехода).
Данный макрос создает подлинники в формате TIFF, после создания присваивает им стадию "Согласовано", а после присоединяет подлинники к бизнес-процессу.

В системе код макроса находится с макросе "Создание подлинника КД на ТО"

---
- [CreatingTestTreeMacro](create-test-tree-macro.cs)

Данный макрос изначально задумывался как тестовый, но в последствии перерос в полноценный инструментарий для тестовой обработки.
Я решил добавлять в этот макрос различную функциональность, которая может пригодится для автоматизации действий, которые приходится делать во время разработки макросов для **T-Flex DOCs**.

---
- [Макрос для обновления комплекта документов](macro-for-updating-complects-of-documents.cs)
- [Макрос для обновления комплекта документов (вызов с стадии)](macro-for-updating-completcs-of-documents-from-stage.cs)

Потребность в данном макросе возникла для внедрения в бизнес-процесс согласования технологической документации обновления комплекта документов каждый раз, когда принимается какое-то согласование (добавляются подписи пользователей), или же эти подписи наоборот убираются.
Макрос был написан для добавления в БП

---
- [Макрос для передачи ТП на хранение](macro-for-changing-stage-to-keeping.cs)

Потребность в этом макросе возникла, когда для бизнес-процесса цеха №2 потребовалось добавить возможность автоматического создания и заполнения карточки изменений в тот момент, когда нормировщик подтверждает правильность заполнения данных.
Изначально я писал свой собственный макрос на основе уже существующего, но в какой-то момент я понял, что самым лучшим вариантом будет дополнение уже существующего макроса (Макрос "PDM-Техпроцессы. Изменения").
Правда, этот макрос я не накатил сразу на рабочую базу, а так же оказывается у меня остался не самая последняя версия данного макроса, поэтому в итоге мне пришлось изрядно попотеть для того, чтобы отыскать эту информацию.
Но зато сейчас здесь все должно быть отмечено.

12.02.2021.
В данный момент макрос перенесен на рабочую базу.
Для этого был изменен макрос "PDM-Техпроцессы. Изменения".
Дополнен бизнес-процесс "АЭМ. Согласование ТД_ц.2" (Добавлен дополнительный этап, в котором нормоконтролер принимает решение заполнить инвентарную карточку объекта после всех согласований);

---

- [Автоматическая нумерация](automate-ordering.cs)

Для того, чтобы в различных справочниках вести автоматическую нумерацию, мной было принято решение о создании единого макроса, который будет хранить различные методу нумерации.
В этом макросе помимо самих методов нумерации так же хранятся методы, которые вызываются из-под конкретных справочников.
В данный момент при помощи этого макроса нумеруется справочник ЦЗЛ, а так же справочник ТЦ

---
- [Обновление локальной папки с макросами](download-macro-from-reference)

Данный макрос был одним из первых, которые я написал в DOCs по своему желанию.
По сути он делал крайне простую задачу - просто переносил все макросы в рабочую папку (которую я жестко закрепил в самом макросе, так что изменить ее было нельзя).

Основное его назначение заключалось в том, что намного более удобно пользоваться текстовыми файлами и любым редактором кода, чем пользоваться встроенным инструментом, который предоставляет docs.
Не смотря на то, что в новой версии этот инструмент был значительно улучшен, он все еще уступает тем редакторам, которые я использую в своей работе, так что данный макрос все еще необходим.

---
- [Тестовый макрос](file-for-test-macro.cs)

Просто тестовый макрос, который используется для отработки всякого разного

---
- [Вспомогательный макрос для экспорта информации](get-list-of-export-files.cs)

Данный макрос был написан для автоматического проведения экспорта.
Необходимость в нем возникла в том, что при экспорте есть два варианта выгрузки - выгрузка без связей или выгрузка со всеми связями.
В том случае, если часть связей не нужна (или же она вызывает ошибки), нет возможности произвести экспорт только с некоторыми связями.
Для того, чтобы обойти данную проблему, я решил написать макрос, который получает список файлов из экспорт-файла для того, чтобы экспортировать их отдельно

В дальнейшем я планирую расширять этот макрос различными правилами проведения экспорта для того, чтобы можно было поднастраивать процесс экспорта более тонко.

---
[Макрос для ЦЗЛ](macro-for-czl.cs)

Макрос, в котором реализована вся логика, которая необходимо для работы ЦЗЛ.
К этому относится расчет сводного наименования, автоматическое формирование отчета из БП, формирование сводного размера, формирование строки, которая передается в отчет для формирования таблицы, шаблонное заполнение данных и т.д.

---
[Тестовая интеграция с 1C](macro-for-test-integration-with-1c.cs)

Данный макрос содержит код, который мне пришлось написать для того, чтобы получать данные с 1С.
К этому относится отправка соответствующего запроса, обработка ответа и произведение соответствующих корректировок в справочниках

---
[Скрипт для формирования отчета](Scripts/generate-report-for-czl.cs)

Вспомогательный скрипт в DevExpress, который формирует таблицу перед формированием протокола для ЦЗЛ
